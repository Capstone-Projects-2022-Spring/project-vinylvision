<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../src/index.css">
    <meta name="theme-color" content="#000000" />
    <title>VinylVision</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script type="text/javascript" src="./key.js"></script>
    <script type="text/javascript" src="./main.js"></script>
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>

<body style = background-color:#FFFFFF>
<img src="../public/logo.jpg" alt="logo" class="center"/>
<noscript>You need to enable JavaScript to run this app.</noscript>
<div id="root"></div>
<div class="centerText">
    <div>
        <p class="centerHeader">Select an audio file</p>
        <div class="row centerHeader">
            <div class="col">
<!--                <label for="audio-input">Choose File</label>-->
                <input type="file" accept=".mp3" id="audio-input"/>
            </div>
            <div class="col">
                <button class="btn btn-sm btn-primary buttonSmall" onclick="submit()">Submit</button>
            </div>
        </div>


        <p class="centerHeader">Results</p>
        <div id="result"></div>
    </div>

    <script>
        const input = document.querySelector("#audio-input");
        var file = null;

        input.addEventListener("change", () => {
            file = input.files.item(0);
        });

        function submit() {
            if (file) {
                var postData = new FormData();
                postData.append('api_token', 'c9406b4f36456e3730cf2cf10c7d5348');
                postData.append('file', file);
                postData.append('return', 'spotify');

                result = document.querySelector('#result');
                result.innerHTML = 'Working...'

                $.ajax({
                    url: 'https://api.audd.io',
                    type: 'POST',
                    data: postData,
                    contentType: false,
                    processData: false,
                    success: function (response) {
                        console.log(response);

                        result.innerHTML =
                            `<table class="table" sty>
                                    <tr>
                                        <td class="centerText">Album</td>
                                        <td class="text-primary centerText">${response.result.album}</td>
                                    </tr>
                                    <tr>
                                        <td class="centerText">Artist</td>
                                        <td class="text-primary centerText">${response.result.artist}</td>
                                    </tr>
                                    <tr>
                                        <td class="centerText">Label</td>
                                        <td class="text-primary centerText">${response.result.label}</td>
                                    </tr>
                                    <tr>
                                        <td class="centerText">Release Date</td>
                                        <td class="text-primary centerText">${response.result.release_date}</td>
                                    </tr>
                                </table>`;
                    }
                });
            }
        }
    </script>
</div>
</body>
</html>